# ğŸš€ Cloud Run API å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸ“¦ é¡¹ç›®æ–‡ä»¶è¯´æ˜

æˆ‘å·²ç»ä¸ºä½ åˆ›å»ºäº†ä¸€ä¸ªå®Œæ•´çš„ Cloud Run API éƒ¨ç½²é¡¹ç›®ï¼ŒåŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

### æ ¸å¿ƒæ–‡ä»¶
1. **main.py** - FastAPI åº”ç”¨ä¸»æ–‡ä»¶ï¼ŒåŒ…å« API é€»è¾‘
2. **requirements.txt** - Python ä¾èµ–åˆ—è¡¨
3. **Dockerfile** - Docker å®¹å™¨é…ç½®
4. **.dockerignore** - Docker æ„å»ºå¿½ç•¥æ–‡ä»¶

### éƒ¨ç½²è„šæœ¬
5. **deploy.sh** - æœ¬åœ°å¿«é€Ÿéƒ¨ç½²è„šæœ¬ï¼ˆéœ€åœ¨ Git Bash / WSL ä¸‹è¿è¡Œï¼‰

### è°ƒç”¨è„šæœ¬
7. **call_api.py** - åŸºç¡€ API è°ƒç”¨è„šæœ¬
8. **api_examples.py** - 8 ç§ä¸åŒçš„ API è°ƒç”¨ç¤ºä¾‹

### æ–‡æ¡£
9. **README.md** - å®Œæ•´çš„ä½¿ç”¨æ–‡æ¡£

## âš¡ ä¸‰æ­¥å¿«é€Ÿéƒ¨ç½²

### 1ï¸âƒ£ å‡†å¤‡å·¥ä½œ
```bash
# å®‰è£… Google Cloud SDK
# macOS: brew install google-cloud-sdk
# å…¶ä»–ç³»ç»Ÿ: https://cloud.google.com/sdk/docs/install

# å®‰è£… Docker Desktop
# https://www.docker.com/products/docker-desktop

# ç™»å½• GCP
gcloud auth login
gcloud auth configure-docker
```

### 2ï¸âƒ£ éƒ¨ç½²ï¼ˆé€‰æ‹©ä¸€ç§æ–¹å¼ï¼‰

**æ–¹å¼ A: GitHub Actions è‡ªåŠ¨éƒ¨ç½²ï¼ˆæ¨èï¼‰**
1. æŒ‰ [GITHUB_SETUP.md](GITHUB_SETUP.md) é…ç½® GCP æœåŠ¡è´¦å·å’Œ GitHub Secretsï¼ˆGCP_PROJECT_IDã€GCP_SA_KEYï¼‰
2. å°†ä»£ç æ¨é€åˆ° GitHub çš„ `main` åˆ†æ”¯ï¼Œæˆ–åˆ°ä»“åº“ Actions é¡µæ‰‹åŠ¨è¿è¡Œ "Deploy to Cloud Run"

**æ–¹å¼ B: æœ¬åœ°ä½¿ç”¨ deploy.sh**
```bash
# 1. ç¼–è¾‘ deploy.shï¼Œå°†ç¬¬ 7 è¡Œ PROJECT_ID æ”¹ä¸ºä½ çš„ GCP é¡¹ç›® ID
# 2. åœ¨ Git Bash æˆ– WSL ä¸­è¿è¡Œï¼š
chmod +x deploy.sh
./deploy.sh
```
Windows ç”¨æˆ·éœ€å…ˆå®‰è£… [Google Cloud SDK](https://cloud.google.com/sdk/docs/install) å’Œ Docker Desktopï¼Œå¹¶åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œ `gcloud auth login`ã€`gcloud auth configure-docker`ã€‚

### 3ï¸âƒ£ è°ƒç”¨ API
```bash
# ä½¿ç”¨è°ƒç”¨è„šæœ¬
python call_api.py https://your-service-url.run.app

# æˆ–ä½¿ç”¨ curl
curl https://your-service-url.run.app/parse \
  -H "Content-Type: application/json" \
  -d '{"text": "æµ‹è¯•æ–‡æœ¬"}'
```

## ğŸ“š API ç«¯ç‚¹

éƒ¨ç½²åï¼Œä½ çš„ API ä¼šæœ‰ä»¥ä¸‹ç«¯ç‚¹ï¼š

- `GET /` - å¥åº·æ£€æŸ¥
- `GET /health` - Kubernetes å¥åº·æ£€æŸ¥
- `POST /parse` - è§£ææ–‡æœ¬æ•°æ®ï¼ˆä¸»è¦ç«¯ç‚¹ï¼‰
- `GET /docs` - Swagger API æ–‡æ¡£ï¼ˆäº¤äº’å¼ï¼‰
- `GET /redoc` - ReDoc API æ–‡æ¡£

## ğŸ¯ API ä½¿ç”¨ç¤ºä¾‹

### Python è°ƒç”¨
```python
import requests

response = requests.post(
    "https://your-service-url.run.app/parse",
    json={
        "text": "è¦è§£æçš„æ–‡æœ¬",
        "format": "json"
    }
)

print(response.json())
```

### cURL è°ƒç”¨
```bash
curl -X POST https://your-service-url.run.app/parse \
  -H "Content-Type: application/json" \
  -d '{"text": "æµ‹è¯•", "format": "json"}'
```

### JavaScript è°ƒç”¨
```javascript
fetch('https://your-service-url.run.app/parse', {
  method: 'POST',
  headers: {'Content-Type': 'application/json'},
  body: JSON.stringify({text: 'æµ‹è¯•', format: 'json'})
})
.then(res => res.json())
.then(data => console.log(data));
```

## ğŸ”§ è‡ªå®šä¹‰è§£æé€»è¾‘

åœ¨ `main.py` çš„ç¬¬ 34-56 è¡Œä¿®æ”¹ `parse_data` å‡½æ•°ï¼š

```python
@app.post("/parse", response_model=ParseResponse)
async def parse_data(request: ParseRequest):
    # åœ¨è¿™é‡Œæ·»åŠ ä½ çš„è‡ªå®šä¹‰è§£æé€»è¾‘
    parsed_data = your_custom_function(request.text)
    
    return ParseResponse(
        success=True,
        data=parsed_data,
        message="è§£ææˆåŠŸ"
    )
```

## ğŸ’¡ å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹æ—¥å¿—
gcloud run services logs read parse-api --region=australia-southeast1

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
gcloud run services describe parse-api --region=australia-southeast1

# æ›´æ–°æœåŠ¡
./deploy.sh

# åˆ é™¤æœåŠ¡
gcloud run services delete parse-api --region=australia-southeast1

# æœ¬åœ°æµ‹è¯•
python main.py
# è®¿é—® http://localhost:8080
```

## ğŸ“ å­¦ä¹ èµ„æº

æŸ¥çœ‹ `api_examples.py` äº†è§£ 8 ç§ä¸åŒçš„è°ƒç”¨æ–¹å¼ï¼š
1. åŸºç¡€åŒæ­¥è°ƒç”¨
2. å¸¦é”™è¯¯å¤„ç†çš„è°ƒç”¨
3. æ‰¹é‡å¤„ç†
4. å¼‚æ­¥è°ƒç”¨
5. å¸¦é‡è¯•æœºåˆ¶
6. æµå¼å¤„ç†å¹¶ä¿å­˜
7. è‡ªå®šä¹‰è¯·æ±‚å¤´
8. å°è£…æˆç±»

## ğŸ’° è´¹ç”¨è¯´æ˜

Cloud Run å‡ ä¹å…è´¹ç”¨äºå°å‹é¡¹ç›®ï¼š
- æ¯æœˆ 200 ä¸‡æ¬¡è¯·æ±‚å…è´¹
- 180,000 vCPU-ç§’/æœˆ å…è´¹
- 360,000 GiB-ç§’/æœˆ å†…å­˜å…è´¹

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

- æŸ¥çœ‹ `README.md` è·å–å®Œæ•´æ–‡æ¡£
- è®¿é—®éƒ¨ç½²çš„ `/docs` ç«¯ç‚¹æŸ¥çœ‹ API æ–‡æ¡£
- è¿è¡Œ `python api_examples.py` æŸ¥çœ‹æ›´å¤šç¤ºä¾‹

---

ç¥ä½ éƒ¨ç½²é¡ºåˆ©ï¼ğŸ‰
